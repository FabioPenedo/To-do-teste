# To-Do API

API RESTful para gerenciamento de tarefas (To-Do List) desenvolvida em .NET 10 com autenticaÃ§Ã£o JWT, PostgreSQL e Docker.

## ğŸ“‹ Sobre o Projeto

Este projeto Ã© uma API completa de gerenciamento de tarefas que permite aos usuÃ¡rios criar, ler, atualizar e deletar tarefas, com sistema de autenticaÃ§Ã£o e autorizaÃ§Ã£o usando JWT (JSON Web Tokens) e Refresh Tokens.

## ğŸš€ Tecnologias

- **.NET 10**
- **Entity Framework Core 9.0.8**
- **PostgreSQL** (Npgsql.EntityFrameworkCore.PostgreSQL)
- **JWT Authentication** (Microsoft.AspNetCore.Authentication.JwtBearer)
- **BCrypt** para hash de senhas
- **Serilog** para logging
- **Swagger/OpenAPI** para documentaÃ§Ã£o
- **Docker** e **Docker Compose** para containerizaÃ§Ã£o

## ğŸ“¦ PrÃ©-requisitos

### OpÃ§Ã£o 1: Executar com Docker (Recomendado)
- [Docker](https://www.docker.com/get-started) instalado
- [Docker Compose](https://docs.docker.com/compose/install/) instalado

### OpÃ§Ã£o 2: Executar localmente
- [.NET 10 SDK](https://dotnet.microsoft.com/download) instalado
- [PostgreSQL](https://www.postgresql.org/download/) instalado e rodando

## ğŸ”§ ConfiguraÃ§Ã£o

### 1. Clone o repositÃ³rio

```bash
git clone https://github.com/FabioPenedo/To-do-teste.git
cd To-do-teste
```

### 2. ConfiguraÃ§Ã£o do Banco de Dados

O projeto estÃ¡ configurado para conectar ao PostgreSQL. As configuraÃ§Ãµes padrÃ£o estÃ£o em `appsettings.json`:

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Port=5432;Database=todo_db;Username=postgres;Password=123456"
  }
}
```

**âš ï¸ Importante:** Para ambientes de produÃ§Ã£o, altere a senha padrÃ£o e use variÃ¡veis de ambiente ou User Secrets.

## ğŸ³ Executando com Docker

A maneira mais fÃ¡cil de executar o projeto Ã© usando Docker Compose, que irÃ¡ subir tanto a API quanto o banco de dados PostgreSQL:

```bash
docker-compose up -d
```
ou 

```bash
iniciando pelo start do visual studio
```

Isso irÃ¡:
- Criar e iniciar o container do PostgreSQL na porta 5432
- Criar e iniciar o container da API nas portas 8080 (HTTP) e 8081 (HTTPS)
- Configurar a rede entre os containers
- Persistir os dados do PostgreSQL em um volume

### Verificar logs dos containers

```bash
# Ver logs da API
docker logs todoteste-api -f

# Ver logs do PostgreSQL
docker logs todoteste-postgres -f
```

### Parar os containers

```bash
docker-compose down
```

### Parar e remover volumes (apaga dados do banco)

```bash
docker-compose down -v
```

## ğŸ’» Executando Localmente (sem Docker)

### 1. Executar as Migrations

No diretÃ³rio do projeto, execute:

```bash
cd To-do-teste
dotnet ef database update
```

### 2. Atualizar a string de conexÃ£o (se necessÃ¡rio)

Edite o arquivo `To-do-teste/appsettings.json` com suas credenciais do PostgreSQL.


Isso irÃ¡ criar todas as tabelas necessÃ¡rias no banco de dados.

### 4. Executar a aplicaÃ§Ã£o

```bash
dotnet run
```

Ou para desenvolvimento com hot reload:

```bash
dotnet watch run
```

A API estarÃ¡ disponÃ­vel em:
- HTTP: `http://localhost:5298`
- HTTPS: `https://localhost:7131`

## ğŸ“š DocumentaÃ§Ã£o da API

ApÃ³s iniciar a aplicaÃ§Ã£o, acesse a documentaÃ§Ã£o Swagger:

- **Com Docker**: `https://localhost:8081/index.html` ou `http://localhost:8080/index.html`
- **Localmente**: `https://localhost:7131/index.html` ou `http://localhost:5298/index.html`

## ğŸ” AutenticaÃ§Ã£o

A API utiliza JWT (JSON Web Tokens) para autenticaÃ§Ã£o. O fluxo Ã©:

1. **Registrar usuÃ¡rio**: `POST /api/auth/register`
2. **Login**: `POST /api/auth/login` - retorna um Access Token (vÃ¡lido por 15 minutos) e um Refresh Token (vÃ¡lido por 7 dias)
3. **Usar o token**: Inclua o token no header `Authorization: Bearer {seu-token}`
4. **Renovar token**: Ele pega do cockie o Refresh Token para obter novos tokens


## ğŸ“ Estrutura do Projeto

```
To-do-teste/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ Controllers/       # Controllers da API
â”‚   â”œâ”€â”€ Services/          # LÃ³gica de negÃ³cio
â”‚   â”œâ”€â”€ Repositories/      # Acesso a dados
â”‚   â”œâ”€â”€ Entities/          # Entidades do banco de dados
â”‚   â”œâ”€â”€ DTOs/              # Data Transfer Objects
â”‚   â”œâ”€â”€ Interfaces/        # Interfaces e contratos
â”‚   â”œâ”€â”€ Middlewares/       # Middlewares customizados
â”‚   â”œâ”€â”€ Data/              # ConfiguraÃ§Ã£o do DbContext
â”‚   â”œâ”€â”€ Configurations/    # ConfiguraÃ§Ãµes da aplicaÃ§Ã£o
â”‚   â””â”€â”€ Logging/           # ConfiguraÃ§Ãµes de log
â”œâ”€â”€ Migrations/            # Migrations do EF Core
â”œâ”€â”€ logs/                  # Arquivos de log
â”œâ”€â”€ Dockerfile             # ConfiguraÃ§Ã£o Docker da API
â”œâ”€â”€ appsettings.json       # ConfiguraÃ§Ãµes da aplicaÃ§Ã£o
â””â”€â”€ Program.cs             # Ponto de entrada da aplicaÃ§Ã£o
```

## ğŸ› ï¸ Comandos Ãšteis

### Entity Framework Core

```bash
# Criar nova migration
dotnet ef migrations add NomeDaMigration

# Aplicar migrations
dotnet ef database update

# Reverter Ãºltima migration
dotnet ef migrations remove

# Ver informaÃ§Ãµes do banco
dotnet ef dbcontext info
```

### Docker

```bash
# Rebuild dos containers
docker-compose up --build

# Ver containers rodando
docker ps

# Entrar no container da API
docker exec -it todoteste-api bash

# Entrar no container do PostgreSQL
docker exec -it todoteste-postgres psql -U postgres -d todo_db
```

## ğŸ“ Logs

Os logs sÃ£o salvos em:
- Console (desenvolvimento)
- Arquivo: `logs/todo-teste-{data}.log`
- RetenÃ§Ã£o: 30 dias

## ğŸ”’ SeguranÃ§a

- Senhas sÃ£o hashadas usando BCrypt
- Tokens JWT com expiraÃ§Ã£o configurÃ¡vel
- Refresh Tokens armazenados no banco de dados
- CORS configurado
- ValidaÃ§Ã£o de dados de entrada

## ğŸ‘¤ Front-end

GitHub: [@Front-end](https://github.com/FabioPenedo/to-do-app)

## ğŸ‘¤ Autor

**Fabio Penedo**

- GitHub: [@FabioPenedo](https://github.com/FabioPenedo)